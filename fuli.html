<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iOS 风格滚动选择器</title>
<style>
  body {
    margin: 0;
    font-family: sans-serif;
    display: flex;
    height: 100vh;
    justify-content: center;
    align-items: center;
    background: #f0f0f0;
    overflow: hidden;
  }

  .picker-container {
    width: 200px;
    height: 200px;
    overflow: hidden;
    position: relative;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    touch-action: none;
  }

  .picker-list {
    position: absolute;
    width: 100%;
    top: 0;
    left: 0;
    transition: transform 0.2s ease-out;
  }

  .picker-item {
    height: 40px;
    line-height: 40px;
    text-align: center;
    font-size: 18px;
    color: #666;
    user-select: none;
  }

  .picker-item.selected {
    color: #000;
    font-weight: bold;
  }

  .picker-mask {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, rgba(240,240,240,1) 0%, rgba(240,240,240,0) 30%, rgba(240,240,240,0) 70%, rgba(240,240,240,1) 100%);
    pointer-events: none;
  }

  .picker-center-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 40px;
    margin-top: -20px;
    border-top: 1px solid #ccc;
    border-bottom: 1px solid #ccc;
    pointer-events: none;
  }
</style>
</head>
<body>
<div class="picker-container">
  <div class="picker-list" id="pickerList"></div>
  <div class="picker-mask"></div>
  <div class="picker-center-line"></div>
</div>

<script>
const items = ["苹果","香蕉","橙子","西瓜","葡萄","菠萝","草莓","芒果","樱桃","梨","选项1","选项2","选项3","选项4","选项5","选项6","选项7","选项8","选项9","选项10"]; 
const itemHeight = 40;
const pickerList = document.getElementById('pickerList');

// 直接使用原始数组
items.forEach(text=>{
  const div = document.createElement('div');
  div.className = 'picker-item';
  div.innerText = text;
  pickerList.appendChild(div);
});

let currentIndex = 0; // 初始第一个
let startY = 0;
let startTime = 0;
let lastY = 0;
let velocity = 0;
let isDragging = false;
let animationFrameId = null;

function clampIndex(){
  if(currentIndex < 0) currentIndex = 0;
  if(currentIndex > items.length-1) currentIndex = items.length-1;
}

function updatePicker(animate = true){
  pickerList.style.transition = animate ? 'transform 0.2s ease-out' : 'none';
  const offset = -currentIndex*itemHeight + Math.floor(5/2)*itemHeight;
  pickerList.style.transform = `translateY(${offset}px)`;
  document.querySelectorAll('.picker-item').forEach((el, idx)=>{
    el.classList.toggle('selected', idx === currentIndex);
  });
}

// 惯性滚动
function momentumScroll(){
  velocity *= 0.8;
  if(Math.abs(velocity) < 0.02){
    currentIndex = Math.round(currentIndex - velocity);
    clampIndex();
    updatePicker();
    return;
  }
  currentIndex -= velocity;
  clampIndex();
  updatePicker(false);
  animationFrameId = requestAnimationFrame(momentumScroll);
}

// 事件处理
function startDrag(e){
  cancelAnimationFrame(animationFrameId);
  isDragging = true;
  startY = e.touches ? e.touches[0].clientY : e.clientY;
  lastY = startY;
  startTime = Date.now();
  velocity = 0;
}

function moveDrag(e){
  if(!isDragging) return;
  e.preventDefault();
  const y = e.touches ? e.touches[0].clientY : e.clientY;
  const delta = y - lastY;
  currentIndex -= delta/itemHeight;
  clampIndex();
  updatePicker(false);
  const now = Date.now();
  velocity = delta / (now - startTime);
  startTime = now;
  lastY = y;
}

function endDrag(){
  if(!isDragging) return;
  isDragging = false;
  momentumScroll();
}

pickerList.addEventListener('mousedown', startDrag);
pickerList.addEventListener('mousemove', moveDrag);
pickerList.addEventListener('mouseup', endDrag);
pickerList.addEventListener('mouseleave', endDrag);
pickerList.addEventListener('touchstart', startDrag);
pickerList.addEventListener('touchmove', moveDrag, {passive:false});
pickerList.addEventListener('touchend', endDrag);

// 鼠标滚轮
pickerList.addEventListener('wheel', function(e){
  e.preventDefault();
  currentIndex += e.deltaY>0?1:-1;
  clampIndex();
  updatePicker();
},{passive:false});

updatePicker(false);
</script>
</body>
</html>

