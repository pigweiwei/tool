<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>复利计算器</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<style>
body {
  margin: 0;
  padding: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: #121212;
  color: #e0e0e0;
}

/* 顶部倍率 */
#topValues {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 10px;
  font-size: 16px;
  color: #90caf9;
}

/* 左侧悬浮导航 */
.left-nav {
  position: fixed;
  top: 50%; 
  left: 0;
  transform: translateY(-50%);
  background: #2c2c2c;
  border-radius: 0 8px 8px 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: width 0.3s;
  z-index: 100;
  box-shadow: 2px 2px 8px rgba(0,0,0,0.5);
  width: 40px; /* 默认收缩宽度 */
}

.left-nav.expanded {
  width: 120px; /* 展开宽度 */
}

.left-nav .toggle-btn {
  cursor: pointer;
  padding: 10px;
  text-align: center;
  background: #1e1e1e;
  color: #90caf9;
  font-size: 20px;
  user-select: none;
}

.left-nav .nav-item {
  padding: 10px;
  white-space: nowrap;
  overflow: hidden;
  transition: all 0.3s;
}

.left-nav.collapsed .nav-item {
  width: 40px; 
  text-overflow: clip; /* 避免出现点 */
  text-align: center;
}

.left-nav.collapsed .nav-item::first-letter {
  display: inline-block;
}

.left-nav.expanded .nav-item {
  width: 120px;
}

/* 输入区 */
.controls {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 10px;
}

.controls input[type="number"] {
  width: 90px;
  padding: 5px;
  border-radius: 5px;
  border: 1px solid #555;
  background: #1e1e1e;
  color: #e0e0e0;
}

.controls input[type="range"] {
  width: 90px;
}

/* 图表 */
.chart-container {
  width: 100%;
  height: 400px;
  padding: 10px;
}
</style>
</head>
<body>

<div id="topValues">
  <div>倍率: <span id="rateVal">1.0</span></div>
  <div>本金: <span id="principalVal">1000</span></div>
  <div>收益: <span id="profitVal">0</span></div>
</div>

<div class="controls">
  <div>
    <input type="number" id="rateInput" value="1" min="1" step="0.1">
    <input type="range" id="rateRange" value="1" min="1" max="5" step="0.1">
  </div>
  <div>
    <input type="number" id="principalInput" value="1000" min="100" step="100">
    <input type="range" id="principalRange" value="1000" min="100" max="10000" step="100">
  </div>
  <div>
    <input type="number" id="periodInput" value="10" min="1" step="1">
    <input type="range" id="periodRange" value="10" min="1" max="50" step="1">
  </div>
</div>

<div class="chart-container">
  <canvas id="myChart"></canvas>
</div>

<!-- 左侧导航 -->
<div class="left-nav collapsed" id="leftNav">
  <div class="toggle-btn" onclick="toggleNav()">☰</div>
  <div class="nav-item">倍率</div>
  <div class="nav-item">本金</div>
  <div class="nav-item">收益</div>
</div>

<script>
function toggleNav() {
  document.getElementById("leftNav").classList.toggle("expanded");
  document.getElementById("leftNav").classList.toggle("collapsed");
}

/* 输入框点击清空 */
document.querySelectorAll('.controls input[type="number"]').forEach(input => {
  input.addEventListener('focus', () => {
    input.value = "";
  });
});

/* 图表初始化 */
const ctx = document.getElementById('myChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: [],
    datasets: [{
      label: '本金变化',
      data: [],
      borderColor: '#90caf9',
      backgroundColor: 'rgba(144,202,249,0.2)',
      fill: true,
      tension: 0.3
    }]
  },
  options: {
    responsive: true,
    plugins: {
      datalabels: {
        color: '#fff'
      }
    },
    scales: {
      y: {
        beginAtZero: false
      }
    }
  }
});

function updateChart() {
  const rate = parseFloat(document.getElementById('rateInput').value) || 1;
  const principal = parseFloat(document.getElementById('principalInput').value) || 0;
  const period = parseInt(document.getElementById('periodInput').value) || 0;

  document.getElementById('rateVal').textContent = rate;
  document.getElementById('principalVal').textContent = principal;

  let labels = [], data = [], total = principal;
  for (let i=1; i<=period; i++) {
    total *= rate;
    labels.push(i);
    data.push(total);
  }
  document.getElementById('profitVal').textContent = (total - principal).toFixed(2);

  chart.data.labels = labels;
  chart.data.datasets[0].data = data;
  chart.update();
}

['rateInput','rateRange','principalInput','principalRange','periodInput','periodRange'].forEach(id=>{
  document.getElementById(id).addEventListener('input', e=>{
    if (id.includes('Input')) {
      document.getElementById(id.replace('Input','Range')).value = e.target.value;
    } else {
      document.getElementById(id.replace('Range','Input')).value = e.target.value;
    }
    updateChart();
  });
});

updateChart();
</script>
</body>
</html>
