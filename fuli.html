<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Picker Demo</title>
<!-- 引入 React 和 ReactDOM UMD -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<!-- Babel 支持 JSX -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
  body {
    font-family: sans-serif;
    background: #f5f5f5;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .wheel-picker-container {
    width: 200px;
    text-align: center;
  }
  .selected-value {
    margin-top: 20px;
    font-size: 18px;
  }
  /* 滚轮样式（模仿官网 3D 效果） */
  .wheel-picker {
    perspective: 1000px;
    height: 200px;
    overflow: hidden;
    border: 1px solid #ccc;
    border-radius: 10px;
    background: #fff;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    position: relative;
  }
  .wheel-item {
    height: 40px;
    line-height: 40px;
    text-align: center;
    font-size: 18px;
    transform-origin: center center -80px;
  }
  .highlight-bar {
    position: absolute;
    top: 80px; /* 高度的一半减 itemHeight/2 */
    left: 0;
    width: 100%;
    height: 40px;
    border-top: 1px solid #f00;
    border-bottom: 1px solid #f00;
    pointer-events: none;
  }
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">

const { useState, useRef, useEffect } = React;

function WheelPicker({ data, value, onChange, height = 200, itemHeight = 40 }) {
  const containerRef = useRef(null);
  const [scrollTop, setScrollTop] = useState(0);

  // 滚动到当前值
  useEffect(() => {
    const index = data.indexOf(value);
    if (index >= 0 && containerRef.current) {
      containerRef.current.scrollTop = index * itemHeight;
    }
  }, [value]);

  // 滚动处理
  const handleScroll = (e) => {
    const scroll = e.target.scrollTop;
    const index = Math.round(scroll / itemHeight);
    const newIndex = Math.min(Math.max(index, 0), data.length -1);
    if (data[newIndex] !== value) {
      onChange(data[newIndex]);
    }
    setScrollTop(scroll);
  };

  return (
    <div style={{ position: "relative" }}>
      <div
        ref={containerRef}
        className="wheel-picker"
        style={{ height: height }}
        onScroll={handleScroll}
      >
        <div style={{ paddingTop: height/2 - itemHeight/2, paddingBottom: height/2 - itemHeight/2 }}>
          {data.map((item, idx) => {
            const offset = (idx * itemHeight) - scrollTop;
            const rotateX = offset / 2; // 简单3D效果
            return (
              <div
                key={idx}
                className="wheel-item"
                style={{ transform: `rotateX(${rotateX}deg)` }}
              >
                {item}
              </div>
            );
          })}
        </div>
      </div>
      <div className="highlight-bar"></div>
    </div>
  );
}

function App() {
  const [value, setValue] = useState("1");
  const data = Array.from({length: 30}, (_, i) => (i+1).toString());

  return (
    <div className="wheel-picker-container">
      <h2>Wheel Picker Demo</h2>
      <WheelPicker
        data={data}
        value={value}
        onChange={setValue}
        height={200}
        itemHeight={40}
      />
      <div className="selected-value">选中: {value}</div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
