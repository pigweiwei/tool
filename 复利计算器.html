<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>复利计算器</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<style>
html,body {
  margin:0;
  padding:0;
  height:100%;
  font-family:Arial,Helvetica,sans-serif;
}
body {
  display:flex;
  flex-direction:column;
  transition:background 0.25s,color 0.25s;
}

/* ====== 页面布局 ====== */
.chart-container {
  flex: 1;
  padding: 20px;
}
.form {
  flex: 1;
  padding: 20px;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  align-items:center;
}

/* 输入行 */
.inputs-row {
  display:flex;
  gap:20px;
  margin-bottom:20px;
}
.input-group {
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}
.input-group label {
  margin-bottom:4px;
}
.input-group input[type=text] {
  padding:6px 30px 6px 6px;
  font-size:14px;
  width:120px;
}
.input-group input[type=range] {
  width:120px;
}

/* 清空按钮 */
.clear-btn {
  margin-left:-25px;
  cursor:pointer;
  color:red;
}

/* 滚动条 */
.scroll-bar-vertical {
  writing-mode: bt-lr;
  -webkit-appearance: slider-vertical;
  width:20px;
  height:240px;
  margin-top:10px;
}

/* 虚拟键盘 */
.num-keyboard {
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:6px;
  margin-top:10px;
}
.num-keyboard button {
  padding:10px;
  font-size:18px;
  cursor:pointer;
  border-radius:6px;
  border:1px solid #ccc;
  background:#f0f0f0;
}
.num-keyboard button.zero {
  grid-column: span 3;
}

/* 结果显示 */
#resultBox {
  position:fixed;
  bottom:10px;
  right:10px;
  background:blue;
  color:#fff;
  padding:6px 12px;
  border-radius:6px;
  font-size:14px;
}

/* ====== 导航条（保持你的版本） ====== */
.nav {
  position:fixed;
  left:0;
  top:0;
  bottom:0;
  width:40px;
  background:#222;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  transition: width 0.3s;
}
.nav:hover {
  width:160px;
}
.nav-item {
  margin:20px 0;
  text-align:center;
}
.nav-item span[data-short] {
  display:block;
}
.nav:hover .nav-item span[data-full] {
  display:block;
}
.nav .nav-item span[data-full] {
  display:none;
}

/* ====== 响应式手机适配 ====== */
@media (max-width: 768px) {
  .chart-container {
    height: 55%;
    padding: 10px;
  }
  .form {
    height: 45%;
    padding: 10px;
  }
  .inputs-row {
    flex-direction: column;
    gap: 10px;
    align-items: center;
  }
  .input-group input[type=text] {
    width: 100%;
    max-width: 300px;
  }
  .input-group input[type=range] {
    width: 100%;
    max-width: 300px;
  }
  .scroll-bar-vertical {
    height: 160px;
    max-width: 100%;
  }
  .num-keyboard {
    gap: 4px;
    padding: 4px;
  }
  .num-keyboard button {
    font-size: 16px;
    min-width: 50px;
  }
  #resultBox {
    font-size: 12px;
    padding: 4px 8px;
  }
  .nav {
    width: 32px;
  }
  .nav:hover {
    width: 120px;
  }
}
</style>
</head>
<body class="light">

<div class="nav">
  <div class="nav-item"><span data-short>复</span><span data-full>复利计算</span></div>
  <div class="nav-item"><span data-short>图</span><span data-full>趋势图表</span></div>
</div>

<div class="chart-container">
  <canvas id="myChart"></canvas>
</div>

<div class="form">
  <div class="inputs-row">
    <div class="input-group">
      <label>本金</label>
      <input type="text" id="principal" value="1000"><span class="clear-btn" onclick="clearInput('principal')">✖</span>
      <input type="range" id="principalRange" min="100" max="10000" value="1000">
    </div>
    <div class="input-group">
      <label>利率 (%)</label>
      <input type="text" id="rate" value="5"><span class="clear-btn" onclick="clearInput('rate')">✖</span>
      <input type="range" id="rateRange" min="1" max="20" value="5">
    </div>
    <div class="input-group">
      <label>期数</label>
      <input type="text" id="periods" value="10"><span class="clear-btn" onclick="clearInput('periods')">✖</span>
      <input type="range" id="periodsRange" min="1" max="50" value="10">
    </div>
  </div>
  <input type="range" class="scroll-bar-vertical" id="scrollBar" min="1" max="50" value="10">
  <div class="num-keyboard">
    <button onclick="pressNum('1')">1</button>
    <button onclick="pressNum('2')">2</button>
    <button onclick="pressNum('3')">3</button>
    <button onclick="pressNum('4')">4</button>
    <button onclick="pressNum('5')">5</button>
    <button onclick="pressNum('6')">6</button>
    <button onclick="pressNum('7')">7</button>
    <button onclick="pressNum('8')">8</button>
    <button onclick="pressNum('9')">9</button>
    <button class="zero" onclick="pressNum('0')">0</button>
  </div>
</div>

<div id="resultBox">倍数: 1x</div>

<script>
let chartCtx = document.getElementById('myChart').getContext('2d');
let chart = new Chart(chartCtx, {
  type:'line',
  data:{
    labels:[],
    datasets:[{
      label:'本金增长',
      data:[],
      borderColor:'blue',
      fill:false
    }]
  },
  options:{
    responsive:true,
    maintainAspectRatio:false
  }
});

function updateChart() {
  let principal = parseFloat(document.getElementById('principal').value)||0;
  let rate = parseFloat(document.getElementById('rate').value)||0;
  let periods = parseInt(document.getElementById('periods').value)||0;

  let data = [];
  let labels = [];
  let value = principal;
  for (let i=1;i<=periods;i++) {
    value = value*(1+rate/100);
    data.push(value);
    labels.push(i);
  }
  chart.data.labels = labels;
  chart.data.datasets[0].data = data;
  chart.update();

  if(principal>0) {
    let multiple = (value/principal).toFixed(2);
    document.getElementById('resultBox').innerText = "倍数: " + multiple + "x";
  }
}
function clearInput(id) {
  document.getElementById(id).value="";
  updateChart();
}
function pressNum(num) {
  let active = document.activeElement;
  if(active && active.tagName==="INPUT" && active.type==="text") {
    active.value = active.value + num;
    updateChart();
  }
}

/* 绑定滚动条和输入框 */
document.getElementById('principalRange').oninput = e=>{
  document.getElementById('principal').value = e.target.value;
  updateChart();
};
document.getElementById('rateRange').oninput = e=>{
  document.getElementById('rate').value = e.target.value;
  updateChart();
};
document.getElementById('periodsRange').oninput = e=>{
  document.getElementById('periods').value = e.target.value;
  document.getElementById('scrollBar').value = e.target.value;
  updateChart();
};
document.getElementById('scrollBar').oninput = e=>{
  document.getElementById('periods').value = e.target.value;
  document.getElementById('periodsRange').value = e.target.value;
  updateChart();
};

updateChart();
</script>
</body>
</html>
